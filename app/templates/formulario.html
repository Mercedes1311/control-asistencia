{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Asistencia</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
</head>

<body class="bg-light">
<div class="container mt-5">
  <div class="card shadow rounded-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">Registro de Asistencia</h4>
    </div>
    <div class="card-body">
      <form method="POST">
        {% csrf_token %}

        <!-- campo empleado -->
        <div class="mb-3">
          <label class="form-label">Empleado:</label>
          <select class="form-select select2" name="empleado" required>
            <option value="">-- Selecciona un empleado --</option>
            {% for emp in empleados %}
              <option value="{{ emp.id_empleado }}">{{ emp.nombres }} {{ emp.apellidos }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- campo asistencia -->
        <div class="mb-3">
          <label class="form-label">Tipo de Asistencia:</label>
          <select name="tipo_evento" id="tipo_evento" class="form-select" required>
            <option value="">-- Selecciona un tipo --</option>
            {% for tipo in tipos_evento %}
              <option value="{{ tipo.id_tipo }}">{{ tipo.nombre_asistencia }}</option>
            {% endfor %}
          </select>
        </div>

        <!-- Campo de descripción -->
        <div class="mb-3" id="descripcion_group" style="display: none;">
          <label class="form-label">Descripción adicional:</label>
          <input type="text" name="descripcion" class="form-control" maxlength="50" placeholder="Ej: Visita al cliente, Cita médica...">
        </div>

        <!-- Campo de envio -->
        <div class="d-grid">
          <button type="submit" class="btn btn-success">Registrar Asistencia</button>
        </div>

      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
  $(document).ready(function () {
    $('.select2').select2({
      placeholder: "Busca un empleado",
      allowClear: true
    });
  });

  //visualizacion del campo descripcion
  document.getElementById('tipo_evento').addEventListener('change', function () {
    const tipoId = parseInt(this.value);
    document.getElementById('descripcion_group').style.display = tipoId > 4 ? 'block' : 'none';
  });
</script>

</body>
</html>
